# Web API Крестики-нолики

## Описание
Реализация REST API для игры в крестики-нолики. Выдача сообщений происходит посредством json.

Из возможностей:
  - создание игроков;
  - примитивная адаптация игрового процесса;
  - просмотр списков имеющихся игроков и игр;
  - управравление списками.

Само приложение состоит из двух контроллеров (матчи и игроки), игорового менеджера и репозитория, хранящего данные в памяти.

> Контроллер нацелен на получение запроса и сбор готовых результатов с репозитория и менеджера.


## Экскурс в репозиторий
Всего их два: 'GamesRepo' и 'PlayersRepo'

У обоих реализованы соответствующие интерфейсы для работы с внедренем зависимостей.

Также имеется возможность сохранения данных в формате Json при помощи JsonHandler.

Основная идея в том, что репозиторий отвечает за выдачу данных, наполнение списков и управлением задачами потоянного хранения (Json).


## Менеджер игр
Чтобы отделись создание, ведение и изменение состояний матчей был добавлен менеджер.

Метод Creategame() смотрит, есть ли два свободных игрока и в положительном случае создает и возврашает новую игру с прикрепленными игроками.

MakeMove() проверяет валидость хода, после чего изменяет данные на игровом поле и менят ход на другого игрока.
> игровое поле является массивом на 9 элементов, где номера индексов  - порядок клеток. Т.е., схематично, игра ведется как-то так:

                                                         0 | 1 | 2
                                                         3 | 4 | 5
                                                         6 | 7 | 8
                                                               
FinishGame() анулирует игровое состояние участников и завершает игру.


# Методы
## Games Controller
### GET /api/games
Возвращает все игры незаконченые игры(законченые сразу удаляются).

### GET /api/games/{id}
Возвращает игру по id. Если нет - 404.

### POST /api/games
Запрашивает создание игры у менеджера.

### DELETE /api/games/{id}
Ищет игру по id, просит менеджера закончить и удалить ее из списка.

### PATCH /api/games/{id}?cell={cell}
Ищет игру по id, после просит менеджера установить знак (X или O).

## Players Controller
### GET /api/players
Возвращает список всех существующих игроков. 

### GET /api/players/{id}
Ишет игрока по id.

### POST /api/players
Создает игрока и добовляет в список.

### DELETE /api/players/{id}
Удаляет игрока из списка.


## Немного о JsonHandler
В нем реализованы два метода:

LoadJsonToList() - загружает все записи из файлов в начале запуска приложения.

DumpJsonFromList() - метод, который переодически заменяет имеющийся json-файл.

> По сути, все изменения данных ведутся через списки репозиториев, а json просто заменяется на более актуальный файл


## Немного о том как пользоваться
В начале нужно содать игроков (менеджер не создает игры без двух свободных).

Далее, можно запостить сам матч. Управление игрой проходит по ее id, а клетка хода указывается через параметр.

При помощи PATCH /api/games/id?cell={n} можно осуществлять ходы. Клетки будут заполняться соответсвующими знаками (первый всегда 'X'), каждый ход сменяясь на другой, автоматически.

По итогу нет какой-то слежки за тем как проходит матч, его окончание инициируется мануально, при помощи DELETE запроса. После, занаятые игроки освобождаются и могу быть выбраны снова.
